/*!
 * author:jieyou
 * contacts:baidu hi->youyo1122
 * see https://github.com/jieyou/dice
 */
!function(a,b,c){function g(a){return Object.prototype.toString.call(a)}function k(){}function l(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function m(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)}function n(a,b){return b?b+a[0].toUpperCase()+a.substr(1):a}function t(a){var b=a.length;return 1===b?a[0]:a[Math.floor(Math.random()*b)]}function u(a,b,c){var d;if(3===arguments.length)a.style[b]=c;else for(d in b)b.hasOwnProperty(d)&&(a.style[d]=b[d])}function v(a){return a.dtime=(new Date).getTime()-a.stime,a.dtime>a.keepAnimationTime?(a._onKeepAnimationEnd(),w(a),void 0):(null!==p&&(a.rafId=r(function(){v(a)}),u(a.wrapper,n("transform",q)+"","rotate("+a.zAngle+"deg) rotateX("+a.xAngle+"deg) rotateY("+a.yAngle+"deg)"),a.curRollIsRotateX?a.yAngle=0:a.xAngle=0,a.zAngle=a.zAngle>360?a.zAngle-360:a.zAngle+10,a.curRollIsRotateX?a.xAngle=a.xAngle>360?a.xAngle-360:a.xAngle+10:a.yAngle=a.yAngle>360?a.yAngle-360:a.yAngle+10),void 0)}function w(a){var b;s(a.rafId),a.rafId=null,a.dtime=0,b=e[a.result],l(a.wrapper,n("transitionEnd",q),a._onEndAnimationEnd),l(a.wrapper,n("transitionEnd",q),a._onRollEnd),u(a.wrapper,n("transition",q),p+"transform "+a.endAnimationTime/1e3+"s ease-out"),u(a.wrapper,n("transform",q),"rotate("+b.z+"deg) rotateX("+b.x+"deg) rotateY("+b.y+"deg)")}function x(a){var b;i.call([1,2,3,4,5,6],function(c){var d=a["face"+c];c===a.result?(b=d.getElementsByTagName("DIV"),i.call(b,function(a){a.style.display="none"}),d.style.zIndex="2000"):d.style.zIndex="1000"}),setTimeout(function(){i.call(b,function(a){a.style.display="block"}),a._onNoAnimationEnd(),a._onRollEnd()},200)}function y(a,c){var e=this;i.call(["edgeLength","radius","hasShadow","shadowTop","keepAnimationTime","endAnimationTime"],function(a){e[a]=c[a]}),e._onKeepAnimationEnd=function(){c.onKeepAnimationEnd.call(e,e.result)},e._onEndAnimationEnd=function(){c.onEndAnimationEnd.call(e,e.result)},e._onNoAnimationEnd=function(){c.onNoAnimationEnd.call(e,e.result)},e._onRollEnd=function(){c.onRollEnd.call(e,e.result)},e.zAngle=0,e.yAngle=0,e.xAngle=0,e.rafId=null,e.stime=0,e.dtime=0,e.hasShadow&&(e.shadow=b.createElement("DIV"),u(e.shadow,{position:"absolute",left:"50%",top:e.shadowTop+"%",height:"0",width:4*e.edgeLength/10+"px",marginLeft:"-"+2*e.edgeLength/10+"px"}),u(e.shadow,n("boxShadow",q),"0 0 "+e.edgeLength+"px "+35*e.edgeLength/100+"px rgba(0, 0, 0, 0.7)"),e.shadow.className="dice_shadow",a.appendChild(e.shadow)),i.call(["wrapper","face1","face2","face3","face4","face5","face6"],function(a,c){e[a]=b.createElement("DIV"),"wrapper"===a?(u(e[a],{position:"absolute",height:e.edgeLength+"px",width:e.edgeLength+"px",top:"50%",left:"50%",marginLeft:"-"+e.edgeLength/2+"px",marginTop:"-"+e.edgeLength/2+"px"}),null!==p&&(u(e[a],n("transformStyle",q),"preserve-3d"),u(e[a],n("transformOrigin",q),"50% 50%")),e[a].className="dice_wrapper"):(u(e[a],f),u(e[a],{height:e.edgeLength-10+"px",width:e.edgeLength-10+"px",borderRadius:e.radius+"px"}),null!==p&&u(e[a],n("transform",q),"rotateX("+d[c].x+"deg) rotateY("+d[c].y+"deg) rotate("+d[c].z+"deg) translateZ("+e.edgeLength/2+"px)"),e[a].className="dice_face dice_"+a,e[a].innerHTML=j.html[c].replace(/\#\{margin\}/g,"margin-top:-"+e.edgeLength/10+"px;margin-left:-"+e.edgeLength/10+"px").replace(/\#\{border\}/g,"border:"+e.edgeLength/10+"px #"+(1===c||4===c?"F":"0")+"00 solid;border-radius:"+e.edgeLength/10+"px"),e.wrapper.appendChild(e[a]))}),u(a,"position","relative"),null!==p&&(u(a,n("perspective",q),"800px"),u(a,n("perspectiveOrigin",q),"50% 50%")),a.appendChild(e.wrapper)}var d=[null,{x:90,y:0,z:0},{x:0,y:0,z:0},{x:0,y:90,z:0},{x:0,y:180,z:0},{x:0,y:-90,z:0},{x:-90,y:0,z:180}],e=[null,{x:270,y:0,z:0},{x:0,y:0,z:0},{x:0,y:270,z:0},{x:180,y:0,z:180},{x:0,y:90,z:0},{x:90,y:0,z:180}],f={position:"absolute",border:"5px solid #fff",backgroundColor:"#fff",fontSize:"0",textAlign:"center"},h=Array.isArray||function(a){return"[object Array]"===g(a)},i=Array.prototype.forEach||function(a){for(var b=0,c=this,d=c.length;d>b;b++)a.call(c[b],c[b],b)},j={tpl:'<div class="dice_circle" style="#{margin};#{border};left:#{left}%;top:#{top}%;width:0;height:0;position:absolute;"></div>',position:[null,[[50,50]],[[50,30],[50,70]],[[28,72],[50,50],[72,28]],[[30,30],[30,70],[70,30],[70,70]],[[28,28],[28,72],[50,50],[72,28],[72,72]],[[28,22.5],[28,50],[28,77.5],[72,22.5],[72,50],[72,77.5]]],html:[null]};!function(a){i.call(a.position,function(b,c){var d=[];b&&(i.call(b,function(b){d.push(a.tpl.replace("#{left}",b[0]).replace("#{top}",b[1]))}),a.html[c]=d.join(""))}),delete a.tpl,delete a.position}(j);var p,q,o=function(){var d,c=navigator.userAgent.match(/(Android);?[\s\/]+([\d.]+)?/),e=!1,f=b.createElement("DIV");return c&&(d=parseFloat(c[2]),e=!isNaN(d)&&3>d),function(a){var b;return e?!1:(b=n("transformStyle",a),f.style[b]="preserve-3d",!!f.style[b].length)}}();!function(a,b){typeof a.webkitTransform===b&&o("webkit")?(p="-webkit-",q="webkit"):typeof a.MozTransform===b&&o("Moz")?(p="-moz-",q="Moz"):typeof a.msTransform===b&&o("ms")?(p="-ms-",q="ms"):p=q=typeof a.transform===b&&o("")?"":null}(b.body.style,"string");var r=a.requestAnimationFrame||a[n("requestAnimationFrame",q)]||function(a){return setTimeout(a,17)},s=a.cancelAnimationFrame||a[n("cancelAnimationFrame",q)]||clearTimeout;y.prototype.roll=function(a){var d,e,b=this;if(null===b.rafId)return h(a)?(d=[],i.call(a,function(a){e=c(a,10),e>=1&&6>=e&&d.push(e)})):"number"==typeof a&&(d=[a]),(!d||h(d)&&!d.length)&&(d=[1,2,3,4,5,6]),b.result=t(d),null!==p?(b.curRollIsRotateX=!!t([0,1]),u(b.wrapper,p+"transition",p+"transform 0s linear"),b.stime=(new Date).getTime(),m(b.wrapper,n("transitionEnd",q),b._onEndAnimationEnd),m(b.wrapper,n("transitionEnd",q),b._onRollEnd),r(function(){v(b)})):x(b),b.result},y.prototype.stop=function(){var a=this;null!==a.rafId&&(s(a.rafId),a.rafId=null)};var z={edgeLength:100,radius:5,hasShadow:!0,shadowTop:75,keepAnimationTime:3e3,endAnimationTime:1e3,onKeepAnimationEnd:k,onEndAnimationEnd:k,onNoAnimationEnd:k,onRollEnd:k};a.dice=function(a,b){var c,d;if(0!==arguments.length){if(b){d={};for(c in z)d[c]=b.hasOwnProperty(c)&&z.hasOwnProperty(c)&&g(z[c])===g(b[c])?b[c]:z[c]}else d=z;return new y(a,d)}}}(window,document,parseInt);